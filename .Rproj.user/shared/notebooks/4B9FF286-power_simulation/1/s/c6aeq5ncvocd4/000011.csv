"0","# Load necessary libraries"
"0","set.seed(123)  # For reproducibility"
"0",""
"0","# Number of participants"
"0","n <- 30"
"0",""
"0","# Original effect sizes for psilocybin and placebo for ASC"
"0","mean_psilo <- 67.88"
"0","sd_psilo <- 6.09"
"0","mean_placebo <- 37.29"
"0","sd_placebo <- 2.48"
"0",""
"0","# Observed data ranges from the provided data"
"0","min_simple_count <- 0"
"0","max_simple_count <- 100   # Based on the observed data"
"0","min_complex_count <- 0"
"0","max_complex_count <- 12   # Based on the observed data"
"0",""
"0","# ASC score ranges"
"0","min_asc <- 0"
"0","max_asc <- 100"
"0",""
"0","# Adjust simulation functions to account for effects observed in the original study"
"0","# Simulate counts with expected effects for Ganzflicker and Ganzfeld"
"0","simulate_counts <- function(mu, size, n, min_val, max_val, multiplier = 1) {"
"0","  simulated_data <- rnbinom(n, size = size, mu = mu * multiplier)"
"0","  # Cap data between observed min and max"
"0","  simulated_data <- pmin(pmax(simulated_data, min_val), max_val)"
"0","  return(simulated_data)"
"0","}"
"0",""
"0",""
"0",""
"0","# Simulate Simple Hallucinations (Number) for Ganzflicker and Ganzfeld"
"0","ganzflicker_simple_mu <- 16.17"
"0","ganzflicker_simple_sd <- 14.72"
"0","ganzfeld_simple_mu <- 5.53"
"0","ganzfeld_simple_sd <- 6.46"
"0",""
"0","size_ganzflicker_simple <- (ganzflicker_simple_mu^2) / (ganzflicker_simple_sd^2 - ganzflicker_simple_mu)"
"0","size_ganzfeld_simple <- (ganzfeld_simple_mu^2) / (ganzfeld_simple_sd^2 - ganzfeld_simple_mu)"
"0",""
"0","ganzflicker_complex_mu <- 1.40"
"0","ganzflicker_complex_sd <- 2.50"
"0","ganzfeld_complex_mu <- 1.40"
"0","ganzfeld_complex_sd <- 2.1"
"0",""
"0","size_ganzflicker_complex <- (ganzflicker_complex_mu^2) / (ganzflicker_complex_sd^2 - ganzflicker_complex_mu)"
"0","size_ganzfeld_complex <- (ganzfeld_complex_mu^2) / (ganzfeld_complex_sd^2 - ganzfeld_complex_mu)"
"0",""
"0","#psilocybin multiplier"
"0","multiplier_psilo <- mean_psilo / mean_placebo"
"0",""
"0",""
"0","# Simulate counts for Ganzflicker and Ganzfeld with differences between Psilocybin and Placebo"
"0","# Increase mu for Psilocybin to simulate higher counts than Placebo"
"0",""
"0","# For Simple Hallucinations"
"0","ganzflicker_simple_psilo <- simulate_counts((multiplier_psilo * ganzflicker_simple_mu), size_ganzflicker_simple, n, min_simple_count, max_simple_count)"
"0","ganzflicker_simple_placebo <- simulate_counts(ganzflicker_simple_mu, size_ganzflicker_simple, n, min_simple_count, max_simple_count)"
"0","ganzfeld_simple_psilo <- simulate_counts((multiplier_psilo * ganzfeld_simple_mu), size_ganzfeld_simple, n, min_simple_count, max_simple_count)"
"0","ganzfeld_simple_placebo <- simulate_counts(ganzfeld_simple_mu, size_ganzfeld_simple, n, min_simple_count, max_simple_count)"
"0",""
"0","# For Complex Hallucinations"
"0","ganzflicker_complex_psilo <- simulate_counts((multiplier_psilo * ganzflicker_complex_mu), size_ganzflicker_complex, n, min_complex_count, max_complex_count)"
"0","ganzflicker_complex_placebo <- simulate_counts(ganzflicker_complex_mu, size_ganzflicker_complex, n, min_complex_count, max_complex_count)"
"0","ganzfeld_complex_psilo <- simulate_counts((multiplier_psilo * ganzfeld_complex_mu), size_ganzfeld_complex, n, min_complex_count, max_complex_count)"
"0","ganzfeld_complex_placebo <- simulate_counts(ganzfeld_complex_mu, size_ganzfeld_complex, n, min_complex_count, max_complex_count)"
"0",""
"0","asc_mu_ganzflicker_simple <- 65.97"
"0","asc_sd_ganzflicker_simple <- 26.63"
"0","asc_mu_ganzfeld_simple <- 40.35"
"0","asc_sd_ganzfeld_simple <- 28.75"
"0","asc_mu_ganzflicker_complex <- 24.36"
"0","asc_sd_ganzflicker_complex <- 22.21"
"0","asc_mu_ganzfeld_complex <- 15.20"
"0","asc_sd_ganzfeld_complex <- 24.61 "
"0",""
"0","# Simulate ASC scores using normal distribution"
"0","simulate_asc <- function(mean_val, sd_val, n, min_val, max_val, offset = 0) {"
"0","  simulated_data <- pmax(rnorm(n, mean_val + offset, sd_val), 0)  # Ensure no negative values"
"0","  # Cap data between observed min and max"
"0","  simulated_data <- pmin(pmax(simulated_data, min_val), max_val)"
"0","  return(simulated_data)"
"0","}"
"0",""
"0",""
"0","# Simulate ASC scores with expected effects, adjusting for Psilocybin vs Placebo differences"
"0","asc_ganzflicker_simple_psilo <- simulate_asc(asc_mu_ganzflicker_simple*multiplier_psilo, asc_sd_ganzflicker_simple, n, min_asc, max_asc)  "
"0","asc_ganzflicker_simple_placebo <- simulate_asc(asc_mu_ganzflicker_simple, asc_sd_ganzflicker_simple, n, min_asc, max_asc) "
"0","asc_ganzflicker_complex_psilo <- simulate_asc(asc_mu_ganzflicker_complex*multiplier_psilo, asc_sd_ganzflicker_complex, n, min_asc, max_asc)  "
"0","asc_ganzflicker_complex_placebo <- simulate_asc(asc_mu_ganzflicker_complex, asc_sd_ganzflicker_complex, n, min_asc, max_asc)  "
"0",""
"0","asc_ganzfeld_simple_psilo <- simulate_asc(asc_mu_ganzfeld_simple*multiplier_psilo, asc_sd_ganzfeld_simple, n, min_asc, max_asc)  "
"0","asc_ganzfeld_simple_placebo <- simulate_asc(asc_mu_ganzfeld_simple, asc_sd_ganzfeld_simple, n, min_asc, max_asc) "
"0","asc_ganzfeld_complex_psilo <- simulate_asc(asc_mu_ganzfeld_complex*multiplier_psilo, asc_sd_ganzfeld_complex, n, min_asc, max_asc)  "
"0","asc_ganzfeld_complex_placebo <- simulate_asc(asc_mu_ganzfeld_complex, asc_sd_ganzfeld_complex, n, min_asc, max_asc)  "
"0",""
"0",""
"0","# Create a dataframe in long format"
"0","simulated_data <- data.frame("
"0","  Participant = rep(1:n, each = 8),"
"0","  Condition = rep(c(""Psilocybin"", ""Placebo""), each = 4, times = n),"
"0","  Hallucination_Type = rep(c(""Simple"", ""Complex""), times = 4 * n),"
"0","  Method = rep(c(""Ganzflicker"", ""Ganzfeld""), each = 2, times = 2 * n),"
"0","  Hallucination_Count = c("
"0","    ganzflicker_simple_psilo, ganzflicker_simple_placebo,"
"0","    ganzflicker_complex_psilo, ganzflicker_complex_placebo,"
"0","    ganzfeld_simple_psilo, ganzfeld_simple_placebo,"
"0","    ganzfeld_complex_psilo, ganzfeld_complex_placebo"
"0","  ),"
"0","  ASC_Score = c("
"0","    asc_ganzflicker_simple_psilo, asc_ganzflicker_simple_placebo,"
"0","    asc_ganzflicker_complex_psilo, asc_ganzflicker_complex_placebo,"
"0","    asc_ganzfeld_simple_psilo, asc_ganzfeld_simple_placebo,"
"0","    asc_ganzfeld_complex_psilo, asc_ganzfeld_complex_placebo"
"0","  )"
"0",")"
"0",""
"0","# Convert to long format"
"0","simulated_data_long <- simulated_data %>%"
"0","  pivot_longer(cols = c(Hallucination_Count, ASC_Score), "
"0","               names_to = ""Measure"", "
"0","               values_to = ""Value"")"
"0",""
"0","# Check the distributions using histograms and boxplots"
"0",""
"0","# Histograms"
"0","ggplot(simulated_data_long, aes(x = Value)) +"
"0","  geom_histogram(bins = 30, fill = 'blue', alpha = 0.7) +"
"0","  facet_wrap(~ Measure + Hallucination_Type + Method, scales = 'free') +"
"0","  theme_minimal() +"
"0","  labs(title = ""Histograms of Simulated Data by Measure, Hallucination Type, and Method"")"
"2","Error in ggplot(simulated_data_long, aes(x = Value)) : 
  could not find function ""ggplot""
"
